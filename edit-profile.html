<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update profile | Antise</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="sass/styles.css">
<!--    <script src="js/validators.js"></script>-->
    <script type="module" src="js/provider.js"></script>
<!--    <script type="module" src="js/userService.js"></script>-->
</head>
<body>

<div class="header">
    <div class="heading">Antise</div>
</div>

<div class="navbar">
    <a href="local-announcements.html">Local announcements</a>
    <a href="user-page.html">
        <div class="profile-container">
            <span id="username">Welcome, <span id="navbar-name"></span></span>
            <img id="navbar-avatar" src="img/user.svg" alt="Profile photo">
        </div>
    </a>
</div>

<div class="caption">Edit profile</div>

<div class="content-container">
    <div class="info-editor-container">
        <form name="userUpdateForm" class="login-reg-form">
            <div id="profile-photo">
                <img id="editor-avatar" src="img/user.svg" alt="Profile photo">
            </div>
            <label class="file-upload">
                <input type="file" id="file-selector" name="file" accept=".jpg, .jpeg, .png">
                <span id="file-info">Click to change photo</span>
            </label>

            <label for="firstname">First name</label>
            <input name="firstname" class="red-input" type="text" id="firstname" required minlength="3" maxlength="16">

            <label for="lastname">Last name</label>
            <input name="lastname" class="red-input" type="text" id="lastname" required minlength="3" maxlength="16">

            <label for="email">Email</label>
            <input name="email" class="red-input" type="text" id="email" required minlength="3" maxlength="45">

            <label for="location">Location</label>
            <input class="red-input" type="text" id="location" required maxlength="15" value="1">
<!--
            <div class="radio-title">Role</div>
            <div class="signup-form-radio">
                <label for="user-choice">Regular</label>
                <input type="radio" id="user-choice" name="role" value="regular" checked>

                <label for="admin-choice">Admin</label>
                <input type="radio" id="admin-choice" name="role" value="admin">
            </div>

            <label for="password-input">Password</label>
            <input class="red-input" type="password" id="password-input" required minlength="5" maxlength="14"
                   value="Hello">

            <label for="confirm-password">Confirm password</label>
            <input class="red-input" type="password" id="confirm-password" required value="Hello">-->

            <div class="submit-button-container">
                <button class="submit-form-button" type="submit" onclick="updateUser()">Submit</button>
            </div>

            <script>
                function updateUser() {
                    const reqURL = 'http://127.0.0.1:5000/users/1';
                    const formData = new FormData(document.forms.userUpdateForm);

                    const xhr = new XMLHttpRequest();
                    xhr.open('PUT', reqURL, false);
                    xhr.setRequestHeader('Authorization', 'Basic ' + localStorage.getItem('basicAuthToken'));
                    xhr.send(formData);
                    console.log(xhr);
                    console.log(xhr.response);
                    alert();


                    const request = new XMLHttpRequest();

                    request.open('GET', reqURL, false);
                    request.send();

                    console.log(request.response);
                    console.log(request.status);
                    alert();

                    const data = JSON.parse(request.response);
                    localStorage.setItem('userData', JSON.stringify((data)));
                }
            </script>

            <div class="delete-account"><a href="announcements.html">Delete an account</a></div>
        </form>
    </div>
</div>
<footer class="footer">
    <div class="footer-right-social">
        <a href="https://www.facebook.com/"><img src="img/footer/facebook.svg" alt=""></a>
        <a href="https://www.instagram.com/"><img src="img/footer/instagram.svg" alt=""></a>
    </div>
    <div class="footer-left">
        <div class="footer-links">
            <a class="link-1" href="#">About</a>
            <a href="#">Contact us</a>
        </div>
        <div class="copyright">Antise &copy; 2021</div>
    </div>
</footer>
</body>
</html>
